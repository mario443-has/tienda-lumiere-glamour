{% extends 'base.html' %}
{% load static %}
{% load humanize %} {# Para usar intcomma #}

{% block title %}Mis Favoritos - Lumière Glamour{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-center text-gray-900 mb-8">Mis Favoritos</h1>

    {% if favoritos %}
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            {% for favorito in favoritos %}
            <div class="bg-white rounded-lg shadow hover:shadow-md transition overflow-hidden relative">
                <a href="{% url 'producto_detalle' favorito.producto.id %}">
                    <img src="{{ favorito.producto.get_primary_image_url }}"
                         alt="{{ favorito.producto.nombre }}"
                         class="w-full h-48 object-cover">
                </a>

                {# El botón de favoritos ahora llama a la función global toggleFavorito de main.js #}
                <button class="btn-favorito absolute top-2 right-2 z-10 active"
                        data-producto-id="{{ favorito.producto.id }}"
                        onclick="toggleFavorito(this, {{ favorito.producto.id }})">
                    <i class="fas fa-heart"></i>
                </button>

                <div class="p-4">
                    <h3 class="text-base font-semibold text-gray-900 mb-1 truncate">{{ favorito.producto.nombre }}</h3>
                    <p class="text-pink-600 font-bold text-sm mb-3">${{ favorito.producto.get_precio_final|floatformat:0|intcomma }}</p> {# Usar intcomma para formato de miles #}
                    <a href="{% url 'producto_detalle' favorito.producto.id %}"
                       class="inline-block w-full text-center bg-pink-600 text-white py-2 rounded-md font-semibold text-sm hover:bg-pink-700 transition">
                        Ver Detalles
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="bg-white rounded-lg shadow-md p-8 text-center mt-16"> {# Añadido estilo al div vacío #}
            <p class="text-gray-600 text-lg mb-4">No tienes productos favoritos aún.</p>
            <a href="{% url 'home' %}" class="inline-block bg-pink-600 text-white px-6 py-3 rounded-md font-semibold hover:bg-pink-700 transition">
                Explorar Productos
            </a>
        </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
{# El script toggleFavorito() ha sido movido a main.js para centralizar la lógica. #}
{# Asegúrate de que main.js esté cargado en base.html y contenga esta función. #}
{% endblock %}
